[supervisord]
nodaemon=true
logfile=/tmp/supervisord.log
pidfile=/tmp/supervisord.pid
user=agentuser

[program:xvfb]
command=/usr/bin/Xvfb :1 -screen 0 1280x800x24
autostart=true
autorestart=true
stdout_logfile=/tmp/xvfb.log
stderr_logfile=/tmp/xvfb.err

[program:vncserver]
command=/bin/bash -c 'mkdir -p ~/.vnc && echo "${VNC_PASSWORD:-password}" | vncpasswd -f > ~/.vnc/passwd && chmod 600 ~/.vnc/passwd && vncserver :1 -geometry 1280x800 -SecurityTypes VncAuth -PasswordFile ~/.vnc/passwd'
autostart=true
autorestart=true
stdout_logfile=/tmp/vncserver.log
stderr_logfile=/tmp/vncserver.err
environment=DISPLAY=":1",VNC_PASSWORD="%(ENV_VNC_PASSWORD)s"

[program:novnc]
command=/opt/noVNC/utils/novnc_proxy --vnc localhost:5901 --listen 6080
autostart=true
autorestart=true
stdout_logfile=/tmp/novnc.log
stderr_logfile=/tmp/novnc.err

[program:agent]
command=gemini --prompt "${JOB_PROMPT:-Default task}" --all-files --approval-mode=yolo
autostart=true
autorestart=true
stdout_logfile=/tmp/agent.log
stderr_logfile=/tmp/agent.err
environment=DISPLAY=":1",JOB_PROMPT="%(ENV_JOB_PROMPT)s"